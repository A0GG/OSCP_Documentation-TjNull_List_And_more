# üóíÔ∏è Example Machine Notes (Machines 161‚Äì169)

### Weasel (TryHackMe)

- **Initial Access:** Discovered an exposed Jupyter Notebook service. A leaked **authentication token** was found on an open SMB share (`datasci-team`), which allowed web access to the Jupyter instance‚Äã[medium.com](https://medium.com/@tommasogreco/tryhackme-weasel-walkthrough-10e0d8565a28#:~:text=smb%3A%20%5Cmisc%5C,Thu%20Aug%2025%2017%3A26%3A47%202022). Using this token, the attacker opened the Jupyter notebook and executed commands on the target, achieving a shell as the low-privilege Linux user.
    
- **Privilege Escalation:** On the Linux side, `sudo -l` revealed the user could run a nonexistent `jupyter` binary as root without a password. The attacker copied `/bin/bash` to the expected `jupyter` path and ran `sudo /home/dev-datasci/.local/bin/jupyter` to pop a root shell‚Äã[medium.com](https://medium.com/@tommasogreco/tryhackme-weasel-walkthrough-10e0d8565a28#:~:text=cp%20%2Fbin%2Fbash%20%2Fhome%2Fdev,datasci%2F.local%2Fbin%2Fjupyter). This provided root access in the Linux (WSL) environment, where they found credentials for the Windows host. Switching to Windows, the attacker discovered **AlwaysInstallElevated** was enabled, generated a malicious `.msi` file, and installed it via `msiexec` to get a **NT AUTHORITY\SYSTEM** shell on Windows‚Äã[medium.com](https://medium.com/@tommasogreco/tryhackme-weasel-walkthrough-10e0d8565a28#:~:text=The%20user%20%E2%80%9Cdev,Let%E2%80%99s%20give%20it%20a%20try)‚Äã[medium.com](https://medium.com/@tommasogreco/tryhackme-weasel-walkthrough-10e0d8565a28#:~:text=runas%20%2Fuser%3Adev,kb1108264.msi%20%2Fqn%E2%80%9D).
    

### AllSignsPoint2Pwnage (TryHackMe)

- **Initial Access:** Investigated an HTTP service hosting a ‚ÄúSimple Slide Show‚Äù and found hints leading to hidden data. The attacker uncovered credentials through steganography/hidden messages in the slideshow images (as the challenge name implied ‚Äúall signs point to pwnage‚Äù)‚Äã[github.com](https://github.com/kartikeyj96/Tryhackme-Writeups/blob/main/AllSignsPoint2Pwnage%20Writeup#:~:text=135%2Ftcp%20open%20msrpc%20syn,127%20Microsoft%20Windows%20RPC). Using the retrieved credentials, they gained an initial user foothold on the Windows target (e.g. via SMB login or RDP, as provided by the puzzle).
    
- **Privilege Escalation:** Enumerating the Windows privileges showed the user had **SeImpersonatePrivilege**. The attacker ran **PrintSpoofer** to abuse this privilege, effectively impersonating a SYSTEM token and spawning a shell as **NT AUTHORITY\SYSTEM**‚Äã[github.com](https://github.com/kartikeyj96/Tryhackme-Writeups/blob/main/AllSignsPoint2Pwnage%20Writeup#:~:text=powershell%20,exe). (Alternatively, obtaining Administrator credentials was possible; the write-up notes the option to use `impacket-wmiexec` with Administrator creds as another path‚Äã[github.com](https://github.com/kartikeyj96/Tryhackme-Writeups/blob/main/AllSignsPoint2Pwnage%20Writeup#:~:text=Microsoft%20Windows%20).)
    

### Anthem (TryHackMe)

- **Initial Access:** Identified the site was running **Umbraco CMS** and discovered default admin credentials (user **`SG`** with password **`UmbracoIsTheBest!`**)‚Äã[medium.com](https://medium.com/@jamesjarviscyber/anthem-tryhackme-full-write-up-walkthrough-summary-28054f93c8cf#:~:text=Let%E2%80%99s%20figure%20out%20the%20username,is%20not%20on%20a%20domain). The attacker logged into the Umbraco admin panel and leveraged its features to execute code (for example, by uploading an ASPX webshell or using a known RCE exploit for the CMS), obtaining a reverse shell as the web server user.
    
- **Privilege Escalation:** While enumerating the filesystem, the attacker found a hidden file named **‚Äúbackups‚Äù** in an accessible directory‚Äã[medium.com](https://medium.com/@jamesjarviscyber/anthem-tryhackme-full-write-up-walkthrough-summary-28054f93c8cf#:~:text=Aha%2C%20there%E2%80%99s%20a%20file%20we,that%20is%20good%20to%20explore). The file‚Äôs ACL was misconfigured, allowing the user to **take ownership/change permissions**. The attacker added their user to the file‚Äôs access list and read it, discovering it contained the **Administrator‚Äôs password**‚Äã[medium.com](https://medium.com/@jamesjarviscyber/anthem-tryhackme-full-write-up-walkthrough-summary-28054f93c8cf#:~:text=So%20we%20don%E2%80%99t%20have%20permission,we%20can%20change%20those%20permissions)‚Äã[medium.com](https://medium.com/@jamesjarviscyber/anthem-tryhackme-full-write-up-walkthrough-summary-28054f93c8cf#:~:text=Click%20on%20SG). With these credentials, they logged in as Administrator and owned the box (Administrator privileges).
    

### Evade Smarter (TryHackMe ‚Äì ‚ÄúHack Smarter Security‚Äù)

- **Initial Access:** Detected a Dell OpenManage Server service on port 1311 and leveraged a known file-read vulnerability (**CVE-2020-5377**) to extract sensitive files‚Äã[medium.com](https://medium.com/@luisgerardomoret_69654/evade-smarter-tryhackme-hack-smarter-security-write-up-5b5e4f7fa1ff#:~:text=There%20is%20nothing%20interesting%20in,file%20possibly%20containing%20sensitive%20information). Using a publicly available exploit, the attacker read the `web.config` of the Dell application, which contained user **Tyler‚Äôs** credentials. They then SSH‚Äôd into the machine as Tyler‚Äã[medium.com](https://medium.com/@luisgerardomoret_69654/evade-smarter-tryhackme-hack-smarter-security-write-up-5b5e4f7fa1ff#:~:text=functionality%20but%20now%20we%20can,file%20possibly%20containing%20sensitive%20information).
    
- **Privilege Escalation:** Regular enumeration was hindered by security software on the host (antivirus/AMSI blocking common scripts). However, manually checking Windows services via the registry revealed **‚ÄúSpoofer Scheduler‚Äù** running as SYSTEM. Its executable was in a path that the Tyler user could modify‚Äã[medium.com](https://medium.com/@luisgerardomoret_69654/evade-smarter-tryhackme-hack-smarter-security-write-up-5b5e4f7fa1ff#:~:text=The%20spoofer,look%20like%20a%20standard%20service). The attacker stopped the service, replaced the service binary with a malicious one (reverse shell), and restarted the service to execute it as SYSTEM‚Äã[medium.com](https://medium.com/@luisgerardomoret_69654/evade-smarter-tryhackme-hack-smarter-security-write-up-5b5e4f7fa1ff#:~:text=The%20spoofer,look%20like%20a%20standard%20service). This yielded a SYSTEM shell. (_Alternate method:_ The author also demonstrated patching AMSI to run PowerShell **PrivescCheck**, which would have identified the same vulnerable service.)
    

### CyberLens (TryHackMe)

- **Initial Access:** Enumerated an HTTP API and identified an **Apache Tika** service on the target. The attacker exploited a known RCE in the Apache Tika server component (by crafting a malicious file for Tika to parse) to execute a reverse shell. After some trial and error, they ultimately used a Metasploit module to successfully gain a **Meterpreter** session as user ‚Äúcyberlens‚Äù on the Windows machine‚Äã[medium.com](https://medium.com/@sodahack/tryhackme-walkthrough-cyberlens-sodatex-f9b696637f05#:~:text=Add%20the%20needed%20Parameters%20%E2%80%9Cset,the%20OSCP%20exam%20anyway%E2%80%A6). (The foothold was achieved without valid credentials, directly through the Tika vulnerability.)
    
- **Privilege Escalation:** Instead of manual enumeration, the attacker leveraged **Metasploit‚Äôs Local Exploit Suggester** to find a privilege escalation exploit. Metasploit identified a suitable vulnerability and executed it, granting a **SYSTEM** shell‚Äã[medium.com](https://medium.com/@sodahack/tryhackme-walkthrough-cyberlens-sodatex-f9b696637f05#:~:text=the%20script). (The exact CVE is not specified in the write-up; this step essentially automated the search and exploitation of an available local vulnerability on the host.)
    

### Escape (VulnLab)

- **Initial Access:** Gained RDP access to a Windows system running in **Kiosk Mode** (a restricted interface). The RDP session did not require a password for the kiosk user login‚Äã[infosecwriteups.com](https://infosecwriteups.com/escape-vulnlab-ever-heard-of-windows-kiosk-mode-no-well-its-time-to-learn-37c4d90fcacd#:~:text=match%20at%20L118%20passwords%20like,know%2C%20the%20usual%20shady%20business). With limited access to the interface, the attacker found a way to download and run **BulletsPassView** (a credential recovery tool) on the kiosk. This revealed saved credentials for an admin-level account on the machine‚Äã[infosecwriteups.com](https://infosecwriteups.com/escape-vulnlab-ever-heard-of-windows-kiosk-mode-no-well-its-time-to-learn-37c4d90fcacd#:~:text=match%20at%20L137%20BulletsPassView%2C%20and,was%20just%20sitting%20there%2C%20chilling). Using those recovered credentials, the attacker was able to open a regular desktop session as the admin user.
    
- **Privilege Escalation:** The kiosk‚Äôs admin account was part of the Administrators group but was running with User Account Control. Since they already had the admin password, the attacker simply performed a **UAC bypass** ‚Äì for example, by launching an elevated command prompt (`Start-Process cmd -Verb runAs`)‚Äã[infosecwriteups.com](https://infosecwriteups.com/escape-vulnlab-ever-heard-of-windows-kiosk-mode-no-well-its-time-to-learn-37c4d90fcacd#:~:text=Now%2C%20here%E2%80%99s%20the%20fun%20part,the%20classic%20UAC%20bypass%20move). This action yielded a high-integrity command shell (since no UAC prompt was present or it was auto-approved), effectively granting full SYSTEM privileges‚Äã[infosecwriteups.com](https://infosecwriteups.com/escape-vulnlab-ever-heard-of-windows-kiosk-mode-no-well-its-time-to-learn-37c4d90fcacd#:~:text=After%20that%2C%20I%20switched%20to,And%20just%20like%20that%E2%80%94owned). With an Administrator-level shell, they owned the machine (and grabbed the ‚ÄúRoot‚Äù flag).
    

### Job (VulnLab)

- **Initial Access:** This scenario emulated a phishing attack. The attacker crafted a malicious **LibreOffice document** with embedded macros and convinced a user on the target to open it. When opened, the macro executed a payload that initiated a reverse shell connection back to the attacker‚Äã[seriotonctf.github.io](https://seriotonctf.github.io/2023/10/25/Job-Vulnlab/index.html#:~:text=Job%20is%20a%20medium%20windows,for%20Privilege%20Escalation). This gave the attacker a foothold as a low-privilege user on the Windows machine.
    
- **Privilege Escalation:** The compromised Windows host granted the user account **SeImpersonatePrivilege**, which the attacker knew could be abused for escalation. They ran a **token impersonation** exploit (e.g. **JuicyPotato** or a similar tool) to create a token for **NT AUTHORITY\SYSTEM**, thereby obtaining a SYSTEM-level shell‚Äã[seriotonctf.github.io](https://seriotonctf.github.io/2023/10/25/Job-Vulnlab/index.html#:~:text=Job%20is%20a%20medium%20windows,for%20Privilege%20Escalation). With SYSTEM access, the machine was fully compromised.
    

### Job 2 (VulnLab)

- **Initial Access:** Another phishing-themed challenge. The attacker prepared a malicious executable (using **msfvenom**) and delivered it to the victim (for instance, via an email attachment or USB drop in the lab scenario). When the victim executed this file, it established a reverse shell to the attacker, giving an initial foothold as a local user on the Windows system. _(This step required user interaction as part of the ‚Äúphishing‚Äù simulation.)_
    
- **Privilege Escalation:** Like the first ‚ÄúJob‚Äù machine, **Job2** also had the user in the local Administrators group with SeImpersonatePrivilege. The attacker employed the **GodPotato** exploit ‚Äì a variant of the token impersonation attack ‚Äì to escalate privileges. By running GodPotato, they exploited the SeImpersonate ability to spawn a shell as **SYSTEM**, thereby gaining complete control of the machine (administrator to SYSTEM)„Äê85‚Ä†L36-L38** (analogue from Job1)**„Äë. The combination of social engineering for initial access and a ‚ÄúPotato‚Äù attack for priv esc resulted in a full compromise.
    

### Lock (VulnLab)

- **Initial Access:** The target was running a local **Gitea** (Git) service and a continuous deployment pipeline for a website. The attacker discovered a **Personal Access Token (PAT)** left in a repository‚Äôs commit history, which granted write access to the code. They used this token to clone the ‚Äúwebsite‚Äù repository and **pushed a webshell (ASPX page)** into it. The CI/CD pipeline deployed the updated website, placing the malicious ASPX on the live server‚Äã[arz101.medium.com](https://arz101.medium.com/vulnlab-lock-2cf8ae6ebe29#:~:text=Lock%20is%20a%20basic%20windows,a%20SYSTEM%20user%20through%20the). By accessing the webshell in a browser, the attacker obtained a reverse shell as the web server user.
    
- **Privilege Escalation:** On the box, the attacker found an **mRemoteNG** configuration file (`confCons.xml`) which contained an encrypted password for a higher-privilege user. Using a known decryptor script, they recovered the password and switched to that user (who had RDP/interactive login rights)‚Äã[arz101.medium.com](https://arz101.medium.com/vulnlab-lock-2cf8ae6ebe29#:~:text=Lock%20is%20a%20basic%20windows,a%20SYSTEM%20user%20through%20the). Now one step away from SYSTEM, the attacker exploited a **vulnerability in PDF24 Creator**. They initiated the PDF24 **‚Äúrepair‚Äù** process, which runs with SYSTEM privileges, while using a file lock trick (oplock) on the log file it writes‚Äã[arz101.medium.com](https://arz101.medium.com/vulnlab-lock-2cf8ae6ebe29#:~:text=The%20vulnerabilities%20lies%20with%20in,actions%20listed%20in%20the%20article). This caused a SYSTEM-level command window to appear (a known exploit for PDF24), which the attacker leveraged to execute a shell as SYSTEM‚Äã[arz101.medium.com](https://arz101.medium.com/vulnlab-lock-2cf8ae6ebe29#:~:text=access%20on,still%20remain%20open%20and%20we). Ultimately, they obtained full SYSTEM access and completed the challenge.